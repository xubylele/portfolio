---
import { languages, type Lang } from '../../i18n/ui';
import { getLangFromUrl, getRelativeUrl } from '../../i18n/utils';

const currentLang = getLangFromUrl(Astro.url);
---

<div class="relative group">
  <button
    class="flex items-center gap-2 text-white/80 hover:text-white transition-colors text-sm font-medium px-3 py-2 rounded-md hover:bg-white/10"
    aria-label="Select language"
  >
    <span>{languages[currentLang]}</span>
    <i class="fa-solid fa-chevron-down text-xs transition-transform group-hover:rotate-180"></i>
  </button>
  
  <div class="absolute right-0 top-full mt-2 bg-[#4b1e3d]/95 backdrop-blur-sm rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 min-w-[120px]">
    <ul class="py-2">
      {Object.entries(languages).map(([lang, label]) => (
        <li>
          <a
            href={`/${lang}`}
            class={`block px-4 py-2 text-sm transition-colors ${
              currentLang === lang
                ? 'text-[#f6ea5d] bg-white/10'
                : 'text-white/80 hover:text-white hover:bg-white/5'
            }`}
            hreflang={lang}
          >
            {label}
          </a>
        </li>
      ))}
    </ul>
  </div>
</div>

<style>
  .group:hover .group-hover\:rotate-180 {
    transform: rotate(180deg);
  }
</style>
